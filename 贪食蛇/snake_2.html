<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        window.onload=function(){
            var body=document.getElementsByTagName('body')[0];
            var time;
            var direct='right';
            var footX;
            var footY;
            var _foot=null;
            var sum=0;

            //设置画布
            var Map=document.createElement('div');
            Map.style.width=800+'px';
            Map.style.height=400+'px';
            Map.style.backgroundColor='#eee';
            Map.style.margin='100px auto';
            Map.style.position='relative';
            body.appendChild(Map);

            //设置食物
            var map=body.children[0];
            foot();

            //设置蛇
            //蛇节信息
            var snakes=[
                [3,3,'red',null],
                [2,3,'blue',null],
                [1,3,'blue',null]
            ];
            show();

            document.onkeyup=function(event){
                var e=event||window.event;
                var code= e.keyCode;
                //取出方向
                switch (code){
                    case 37:
                        direct='left';
                        break;
                    case 38:
                        direct='up';
                        break;
                    case 39:
                        direct='right';
                        break;
                    case 40:
                        direct='down';
                        break;
                }
            };

            //让蛇走起来
            time=setInterval(function(){
                var length=snakes.length;
                for(var i=length-1;i>0;i--){    //共有几个蛇节
                    //设置后面蛇节的坐标等于前面蛇节的坐标
                    snakes[i][0]=snakes[i-1][0];      //让蛇动起来
                    snakes[i][1]=snakes[i-1][1];      //让蛇动起来
                }
                //设置方向
                switch (direct){
                    case 'left':
                        snakes[0][0]-=1;
                        break;
                    case 'right':
                        snakes[0][0]+=1;
                        break;
                    case 'up':
                        snakes[0][1]-=1;
                        break;
                    case 'down':
                        snakes[0][1]+=1;
                        break;
                }

                if(snakes[0][0]==footX && snakes[0][1]==footY){
                    var lengths=length-1;
                    var x=snakes[lengths][0];
                    var y=snakes[lengths][1];
                    snakes.push([x,y,'blue',null]);
                    sum++;
                    document.title='共'+sum+'分';
                    foot();
                }

                var snake1=snakes[0][0];
                var snake2=snakes[0][1];
                if(snake1==40 || snake1==-1 || snake2==20 || snake2==-1){
                    body.children[0].className='map';
                    over();
                    clearInterval(time);
                    return;
                }

                for(var i=1;i<snakes.length;i++){
                    if(snakes[0][0]==snakes[i][0] && snakes[0][1]==snakes[i][1]){
                        over();
                        clearInterval(time);
                        return;
                    }
                }
                show();
            },100);

            function over(){
                var body=document.getElementsByTagName('body')[0];
                var map=body.children[0];
                var over=document.createElement('div');
                map.appendChild(over);
                over.innerHTML='Game Over!!!';
                over.style.fontSize=50+'px';
                over.style.color='red';
                over.style.textAlign='center';
                over.style.lineHeight=map.offsetHeight-100+'px';
                map.style.backgroundColor="#fff";
                map.style.opacity='0.4';
            }
            function show(){
                for(var i=0;i<snakes.length;i++){
                    if(snakes[i][3]==null){
                        snakes[i][3]=document.createElement('div');
                        snakes[i][3].className='snake';
                        snakes[i][3].style.width=20+'px';
                        snakes[i][3].style.height=20+'px';
                        snakes[i][3].style.position='absolute';
                        snakes[i][3].style.backgroundColor=snakes[i][2];
                        map.appendChild(snakes[i][3]);
                    }
                    snakes[i][3].style.left=(snakes[i][0]*20)+'px';
                    snakes[i][3].style.top=(snakes[i][1]*20)+'px';
                }
            }
            function foot(){
                if(_foot==null){
                    _foot=document.createElement('div');
                    _foot.className='foot';
                    _foot.style.width=20+'px';
                    _foot.style.height=20+'px';
                    _foot.style.backgroundColor='green';
                    _foot.style.position='absolute';
                    map.appendChild(_foot);
                }
                footX=Math.floor(Math.random()*40);
                footY=Math.floor(Math.random()*20);
                _foot.style.left=(footX*20)+'px';
                _foot.style.top=(footY*20)+'px';
            }
        }
    </script>
</head>
<body style="background-color: black">
</body>
</html>